<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/WEB-INF/templates/template.xhtml"
                xmlns:p="http://primefaces.org/ui">

  <ui:param name="title" value="Úřední deska - Obec Tršice"/>

  <ui:define name="content">
    <ui:include src="/WEB-INF/includes/editorSettings.xhtml"/>
    <ui:include src="/WEB-INF/includes/inputCalendarSettings.xhtml"/>
    
    <h2>Úřední deska, administrace</h2>

    <ui:include src="/WEB-INF/includes/filesButton.xhtml"/>

    <h:form>
      <p:panelGrid layout="grid" columns="6" styleClass="ui-noborder">
	<p:column/>
	<p:column/>
	<p:column/>
	<p:column/>
	<p:commandButton value="Nový záznam"
			 action="#{officialDeskBean.newDeskItem}"
			 disabled="#{!empty officialDeskBean.deskItem}"
			 update="@form"
			 resetValues="true"/>
	<p:commandButton value="Smazat"
			 action="#{officialDeskBean.delete}"
			 disabled="#{empty officialDeskBean.deskItem}"
			 onclick="return confirm('Opravdu smazat?')"
			 update="@form :growl"
			 resetValues="true"
			 immediate="true"/>
      </p:panelGrid>

      <p:dataTable id="officialDesk" 
                   value="#{officialDeskBean.deskItems}" 
                   emptyMessage="Nenalezen žádný výsledek."
                   selectionMode="single"
                   selection="#{officialDeskBean.deskItem}"
                   rowKey="#{deskItem.id}"
		   rows="5"
		   paginator="true"
		   paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink}"
		   paginatorPosition="bottom"
                   var="deskItem">
        <p:ajax event="rowSelect"
		update="@form"
		resetValues="true"/>
        <p:column headerText="Dokument"
		  style="width: 70%"
		  filterBy="#{deskItem.body}"
		  filterMatchMode="contains">
          <h:outputText value="#{deskItem.body}" escape="false"/>
        </p:column>
	<p:column headerText="Vyvěšeno" style="width: 15%">
          <h:outputText value="#{deskItem.activeFrom}">
	    <f:convertDateTime type="date" pattern="dd.MM.yyyy"/>
	  </h:outputText>
        </p:column>
	<p:column headerText="Sejmuto" style="width: 15%">
          <h:outputText value="#{deskItem.activeTo}">
	    <f:convertDateTime type="date" pattern="dd.MM.yyyy"/>
	  </h:outputText>
        </p:column>
      </p:dataTable>

      <p:panelGrid layout="grid"
		   columns="1"
		   rendered="#{!empty officialDeskBean.deskItem}"
		   styleClass="ui-noborder">
	<p:panelGrid layout="grid" columns="2" styleClass="ui-noborder">
	  <p:panelGrid layout="grid" columns="1" styleClass="ui-noborder">
	    <p:outputLabel value="Vyvěšeno" for="from"/>
	    <p:calendar id="from"
			value="#{officialDeskBean.deskItem.activeFrom}"
			locale="cz"
			mode="inline" />
	  </p:panelGrid>

 	  <p:panelGrid layout="grid" columns="1" styleClass="ui-noborder">
	    <p:outputLabel value="Sejmuto" for="to"/>
	    <p:calendar id="to"
			value="#{officialDeskBean.deskItem.activeTo}"
			locale="cz"
			mode="inline" />
	  </p:panelGrid>
	</p:panelGrid>

	<p:outputLabel value="Dokument" for="body"/>
        <p:textEditor id="body"
		      value="#{officialDeskBean.deskItem.body}"
		      height="300"/>

	<p:panelGrid layout="grid"
		     columns="2"
		     styleClass="ui-noborder">
	  <p:commandButton value="Uložit" 
                           action="#{officialDeskBean.save}"
			   styleClass="default"
			   ajax="false"
			   update=":growl @form"/>
	  <p:commandButton value="Zrušit" 
                           action="#{officialDeskBean.cancelEdit}"
			   immediate="true"
			   resetValues="true"
                           update="@form"/>
	</p:panelGrid>	
      </p:panelGrid>
    </h:form>
  </ui:define>
</ui:composition>
